<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Recording</title>
  <meta name="author" content="jibing57">
  
  <meta name="description" content="AWS, 阅读, Architecture, PostgreSQL">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Recording"/>

  
    <meta property="og:image" content="undefined"/>
  

  
  
    <link href="/favicon.png" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/bootstrap.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/comment.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>
  
  <!-- analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-111771042-1', 'auto');
  ga('send', 'pageview');
</script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?59d3e14cdc96877383afed646f44d216";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>

 <body>  
  <nav id="main-nav" class="navbar  navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">Recording</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/books" title="Douban">
			  <i class="fa fa-book"></i>Douban
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 <div class="page-header ">
  <h1 class="title ">Recording, Sharing, TimeSaving -- 一切成本皆时间</h1>
</div>

<div class="row page">

	
	<div class="col-md-9">
	

		<div class="slogan">
      <i class="fa fa-heart"></i>
      Study hard and make progress every day!
</div>    
		<div id="top_search"></div>
		<div class="mypage">
		
		<!-- title and entry -->
        <!-- render top articles firstly -->
        
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
        
        <!-- render other articles -->
        
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2020-07-03 </div>
			<div class="article-title"><a href="/2020/07/03/redis-basic/" >Redis基础</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>Redis基础知识</p>
<h2 id="Redis-CentOS7下安装"><a href="#Redis-CentOS7下安装" class="headerlink" title="Redis CentOS7下安装"></a>Redis CentOS7下安装</h2><p>Redis的安装，有epel和remi两个yum源可选。当然也可以选择从源码安装。<br>如下介绍epel和remi的两种安装方式。</p>
<h3 id="EPEL安装"><a href="#EPEL安装" class="headerlink" title="EPEL安装"></a>EPEL安装</h3><p>CentOS 7中EPEL中redis最新的版本是3.2.12-2</p>
<p>安装命令如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">sudo yum install epel-release yum-utils</div><div class="line">sudo yum install redis</div><div class="line">sudo systemctl start redis</div><div class="line">sudo systemctl enable redis</div><div class="line">sudo systemctl status redis</div></pre></td></tr></table></figure></p>
	
	</div>
  <a type="button" href="/2020/07/03/redis-basic/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2020-06-29 </div>
			<div class="article-title"><a href="/2020/06/29/transaction-isolation-level-in-postgresql-and-mysql/" >Postgresql和Mysql中的事务隔离</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<h2 id="事务的定义"><a href="#事务的定义" class="headerlink" title="事务的定义"></a>事务的定义</h2><p>事务拥有四个重要的特性：</p>
<ul>
<li>原子性（Atomicity）<ul>
<li>事务开始后所有操作，要么全部做完，要么全部不做，不可能停滞在中间环节。事务执行过程中出错，会回滚到事务开始前的状态，所有的操作就像没有发生一样。</li>
</ul>
</li>
<li>一致性（Consistency）<ul>
<li>指事务将数据库从一种状态转变为另一种一致的的状态。事务开始前和结束后，数据库的完整性约束没有被破坏。</li>
</ul>
</li>
<li>隔离性（Isolation）<ul>
<li>要求每个读写事务的对象对其他事务的操作对象能互相分离，即该事务提交前对其他事务不可见。 也可以理解为多个事务并发访问时，事务之间是隔离的，一个事务不应该影响其它事务运行效果。这指的是在并发环境中，当不同的事务同时操纵相同的数据时，每个事务都有各自的完整数据空间。由并发事务所做的修改必须与任何其他并发事务所做的修改隔离。</li>
</ul>
</li>
<li>持久性（Durability）<ul>
<li>事务一旦提交，则其结果就是永久性的。即使发生宕机的故障，数据库也能将数据恢复，也就是说事务完成后，事务对数据库的所有更新将被保存到数据库，不能回滚。<br>这四个特性就是常说的数据库的ACID 特性</li>
</ul>
</li>
</ul>
	
	</div>
  <a type="button" href="/2020/06/29/transaction-isolation-level-in-postgresql-and-mysql/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2020-06-23 </div>
			<div class="article-title"><a href="/2020/06/23/resolve-sudo-error-in-crontab-job/" >Crontab中解决sorry, you must have a tty to run sudo的方法</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>crontab中使用sudo切换用户执行命令<code>sudo -u user command</code>时，会报<code>sudo: sorry, you must have a tty to run sudo</code>的错误。</p>
<h3 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h3><p>在一些Linux发行版中，会默认设置运行<code>sudo</code>需要在tty中运行。以CentOS 7.0为例，在<code>/etc/sudoers</code>中, 有一个默认设置<code>Defaults    requiretty</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#</div><div class="line"># Disable &quot;ssh hostname sudo &lt;cmd&gt;&quot;, because it will show the password in clear.</div><div class="line">#         You have to run &quot;ssh -t hostname sudo &lt;cmd&gt;&quot;.</div><div class="line">#</div><div class="line">Defaults    requiretty</div></pre></td></tr></table></figure></p>
	
	</div>
  <a type="button" href="/2020/06/23/resolve-sudo-error-in-crontab-job/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2020-06-21 </div>
			<div class="article-title"><a href="/2020/06/21/tools-to-control-brightness-of-external-monitor-on-macos/" >Mac下调节外置显示器亮度的工具</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<h3 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h3><p>家里缺台显示器，趁着狗东6.18活动，入手了一台AOC U2790PQU(穷人表示买不起Dell U2720)。</p>
<p>到货后拆箱试用，检测了下屏幕，没有坏点, 而且在mac下即插即用，屏幕自动适应缩放，不用特殊设置缩放。一切都挺好。</p>
<p>唯一的问题是，AOC这台显示器亮度太亮了，我已经在显示器设置中将亮度设为0了，屏幕亮度还是太亮。</p>
<p>有问题就得尝试解决，于是上网搜索解决方案。</p>
<h3 id="需要解决的问题"><a href="#需要解决的问题" class="headerlink" title="需要解决的问题"></a>需要解决的问题</h3><p><strong>问题: 显示器亮度太亮，物理调节亮度为0后，黑暗中还是太亮。</strong></p>
<p>网上搜了一圈，找到了4个在MacBook Pro上实现亮度调节的方法，记录如下: </p>
<h4 id="相关说明"><a href="#相关说明" class="headerlink" title="相关说明"></a>相关说明</h4><p>网上有说有些方法在某些系统上不起作用。因此贴一下我这边的系统配置, 下面的记录基于如下系统配置。<br><strong>电脑型号: MacBook Pro (13-inch, 2018, Four Thunderbolt 3 Ports)</strong><br><strong>操作系统版本: macOS Mojave 10.14.4 (18E226)</strong></p>
	
	</div>
  <a type="button" href="/2020/06/21/tools-to-control-brightness-of-external-monitor-on-macos/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2020-06-09 </div>
			<div class="article-title"><a href="/2020/06/09/some-new-nginx-config/" >一些常用的Nginx+Passenger配置</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>摘记一些常用的nginx和passenger(Passenger + Nginx)配置</p>
<h2 id="Basic验证"><a href="#Basic验证" class="headerlink" title="Basic验证"></a>Basic验证</h2><p>测试环境的服务要放到互联网上时，如果为了避免测试服务的内容被搜索引擎收录，或者只提供给部分用户试用时，可以设置Basic Auth来限制访问。Basic Auth可以在应用层做，也可以在Nginx侧简单的设置。</p>
<p>如下是Nginx侧的设置方法, 摘录自Nginx官网文章<a href="https://docs.nginx.com/nginx/admin-guide/security-controls/configuring-http-basic-authentication/" target="_blank" rel="external">Restricting Access with HTTP Basic Authentication</a></p>
<h3 id="设置htpasswd"><a href="#设置htpasswd" class="headerlink" title="设置htpasswd"></a>设置htpasswd</h3><ol>
<li>确保apache2-utils (Debian, Ubuntu) 或者 httpd-tools (RHEL/CentOS/Oracle Linux)已经安装。</li>
<li><p>创建htpasswd文件, 使用<code>-c</code>来创建新文件。如下是给用户名carl生成.htpasswd文件，在提示信息中输入访问密码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ sudo htpasswd -c /etc/nginx/.htpasswd carl</div><div class="line">New password:</div><div class="line">Re-type new password:</div><div class="line">Adding password for user carl</div><div class="line">$</div></pre></td></tr></table></figure>
</li>
<li><p>如果要创建新的用户，那么去掉<code>-c</code>参数，往htpasswd文件中添加用户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ sudo htpasswd /etc/nginx/.htpasswd shen</div><div class="line">New password:</div><div class="line">Re-type new password:</div><div class="line">Adding password for user shen</div><div class="line">$</div></pre></td></tr></table></figure>
</li>
<li><p>确认.htpasswd文件中是否包含了刚设置的用户carl和shen</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ cat /etc/nginx/.htpasswd</div><div class="line">carl:$apr1$ofR4vRu4$RwMK.HQawTD8/v.YOA2/d.</div><div class="line">shen:$apr1$c1vlrfgt$TqDy9JDsNcGyfTzcSOPLG0</div><div class="line">$</div></pre></td></tr></table></figure>
</li>
</ol>
	
	</div>
  <a type="button" href="/2020/06/09/some-new-nginx-config/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2020-06-06 </div>
			<div class="article-title"><a href="/2020/06/06/screen-overview-of-ak-tech/" >屏幕知识概观</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>前几天看到了一个讲解显示器显示技术的科普视频，感觉蛮不错的。摘录了一些内容如下。</p>
<p>视频playlist链接: </p>
<ul>
<li>Youtube - <a href="https://www.youtube.com/playlist?list=PLqybz7NWybwWcl_s-VLB_tXqbbBww6nbK" target="_blank" rel="external">AK‘s Tech Studio - 硬核显示技术系列视频 有关显示器 显示技术和屏幕 一切你需要知道的事</a></li>
<li>B站<ul>
<li><a href="https://www.bilibili.com/video/BV1eV411o76N" target="_blank" rel="external">「硬核显示技术第一期」LCD和OLED的显示原理和优缺点</a></li>
<li><a href="https://www.bilibili.com/video/BV1nf4y1S7EC" target="_blank" rel="external">「硬核显示技术第二期」各种显示器和屏幕的参数 一切你需要知道的</a></li>
<li><a href="https://www.bilibili.com/video/BV1aK4y1k7K5" target="_blank" rel="external">「硬核显示技术第三期」显示器刷新率和FPS详解</a></li>
<li><a href="https://www.bilibili.com/video/BV1N54y1R7wh" target="_blank" rel="external">为什么玩游戏要用高刷新率屏幕「硬核显示技术第四期」</a></li>
<li><a href="https://www.bilibili.com/video/BV1of4y117M8" target="_blank" rel="external">「硬核显示技术第五期」详解一加8Pro的MEMC插帧补偿技术</a></li>
</ul>
</li>
</ul>
	
	</div>
  <a type="button" href="/2020/06/06/screen-overview-of-ak-tech/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2020-05-31 </div>
			<div class="article-title"><a href="/2020/05/31/how-to-speed-minecraft-launcher-on-macos/" >在MacOS上加速Minecraft Launcher</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<h3 id="状况"><a href="#状况" class="headerlink" title="状况"></a>状况</h3><p>周末小朋友在家玩Minecraft，可能是近期网络环境有什么变动。官方启动器下载更新文件特别的慢。十分钟进度条才动了一小格子。</p>
<p>看着进度条好久也不更新，小朋友渐渐地就变得烦躁起来。</p>
<p>我把梯子开了全局代理，重新启动了Minecraft客户端，但貌似没效果。流量压根不从梯子走。</p>
<p>后来自己折腾了一下，找到了一个方法，记录如下:</p>
<h3 id="方法步骤"><a href="#方法步骤" class="headerlink" title="方法步骤"></a>方法步骤</h3><ol>
<li><p>从App中点开Minecraft，然后开启Terminal，找到启动器的进程信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ ps -ef | grep -i minecraft</div><div class="line">  501 11957     1   0  3:45PM ??         0:00.21 /Applications/Minecraft.app/Contents/MacOS/launcher</div><div class="line">  501 11959 11957   0  3:45PM ??         0:01.98 /Applications/Minecraft.app/Contents/Minecraft Updater.app/Contents/MacOS/nativeUpdater --nativePath /Applications/Minecraft.app --nativeStartupPath /Applications/Minecraft.app/Contents --nativeExecutable /Applicati      ons/Minecraft.app/Contents/MacOS/launcher</div><div class="line">  501 12917 12152   0  3:46PM ttys014    0:00.00 ggrep -i minecraft</div><div class="line">$</div></pre></td></tr></table></figure>
</li>
<li><p>在Terminal中启动HTTP proxy(我本地翻墙的proxy端口绑定的是8001端口，可根据实际情况进行修改。)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ export http_proxy=&quot;http://127.0.0.1:8001&quot;; export HTTP_PROXY=&quot;http://127.0.0.1:8001&quot;; export https_proxy=&quot;http://127.0.0.1:8001&quot;; export HTTPS_PROXY=&quot;http://127.0.0.1:8001&quot;</div></pre></td></tr></table></figure>
</li>
<li><p>关闭GUI的启动器界面, 然后手动在Terminal中启动Launcher</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ /Applications/Minecraft.app/Contents/MacOS/launcher</div><div class="line">2020-05-30 15:48:55.733 launcher[14037:45644] Claimed it found a path: /Applications/Minecraft.app/Contents/MacOS/launcher (/Applications/Minecraft.app/Contents/MacOS/launcher) 4096</div><div class="line">https://launchermeta.mojang.com/v1/products/launcher/022631aeac4a9addbce8e0503dce662152dc398d/mac-os.json</div><div class="line">2020-05-30 15:48:58.496 nativeUpdater[14040:45717] Found executable path: /Applications/Minecraft.app/Contents/MacOS/launcher</div><div class="line">2020-05-30 15:48:58.506 nativeUpdater[14040:45717] Found executable path: /Applications/Minecraft.app/Contents/MacOS/launcher</div><div class="line">https://launchermeta.mojang.com/v1/products/launcher/022631aeac4a9addbce8e0503dce662152dc398d/mac-os.json</div></pre></td></tr></table></figure>
</li>
<li><p>此时，也会启动GUI画面的启动器，但是下载文件时，启动器就会走proxy了。</p>
</li>
</ol>

	
	</div>
  <a type="button" href="/2020/05/31/how-to-speed-minecraft-launcher-on-macos/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2020-05-27 </div>
			<div class="article-title"><a href="/2020/05/27/Add-registry-mirror-to-docker/" >Docker添加国内镜像源</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>在国内访问<a href="https://hub.docker.com/" target="_blank" rel="external">Docker Hub</a>的速度有点慢，换国内源会稳定和快一点。</p>
<h3 id="国内的几个源"><a href="#国内的几个源" class="headerlink" title="国内的几个源:"></a>国内的几个源:</h3><ul>
<li><a href="https://dockerhub.azk8s.cn" target="_blank" rel="external">https://dockerhub.azk8s.cn</a> - Azure镜像</li>
<li><a href="http://hub-mirror.c.163.com" target="_blank" rel="external">http://hub-mirror.c.163.com</a>  - 网易镜像</li>
<li><a href="https://docker.mirrors.ustc.edu.cn" target="_blank" rel="external">https://docker.mirrors.ustc.edu.cn</a> - 科大镜像站</li>
<li><a href="https://registry.docker-cn.com" target="_blank" rel="external">https://registry.docker-cn.com</a> - Docker中国官方镜像 </li>
<li>阿里云也有镜像，只不过需要登录<a href="https://cr.console.aliyun.com/" target="_blank" rel="external">阿里云控制台</a>后获取自己专属的镜像源。</li>
</ul>
<h3 id="设置方法"><a href="#设置方法" class="headerlink" title="设置方法"></a>设置方法</h3><p>参照<a href="https://cloud.google.com/container-registry/docs/using-dockerhub-mirroring" target="_blank" rel="external">Using Container Registry’s Docker Hub mirror</a>这边描述，共有这么几个设置方法</p>
<ol>
<li><p>在配置文件中添加<code>registry-mirrors</code>的配置。启动时自动配置，Linux下的默认配置文件是<code>/etc/docker/daemon.json</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;registry-mirrors&quot;: [&quot;https://&lt;my-docker-mirror-host&gt;&quot;]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>手动启动dockerd的时候，添加<code>--registry-mirror</code>参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dockerd --registry-mirror=https://&lt;my-docker-mirror-host&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
	
	</div>
  <a type="button" href="/2020/05/27/Add-registry-mirror-to-docker/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2020-05-04 </div>
			<div class="article-title"><a href="/2020/05/04/imageMagick-fonts-issue-on-Aliyun-Linux-2/" >Aliyun Linux 2上imageMagick的fonts配置问题</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<h3 id="现象"><a href="#现象" class="headerlink" title="现象"></a>现象</h3><p>公司阿里云服务器部署Rails程序时，发现Gem <a href="https://github.com/pludoni/simple-captcha" target="_blank" rel="external">simple_captcha2</a>生成的验证码图片，和以前的不太一样。图片中的数字会比正常情况下靠上很多, 影响用户体验。</p>
<p>正常情况下的图片:<br><img src="/images/ImageMagick/fonts_normal.jpeg" alt="fonts_normal.jpeg"></p>
<p>有问题的图片:<br><img src="/images/ImageMagick/fonts_crooked_image.jpeg" alt="crooked_image.jpeg"></p>
<h3 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h3><p>Aliyun Linux 2(也包含最新的CentOS 7)中升级了ImageMagick的版本到<code>ImageMagick 6.9.10-68</code>, 字体配置文件<code>/etc/ImageMagick-6/type.xml</code>中默认改用了<code>urw-base35-fonts</code>，而不是之前的<code>ghostscript-fonts</code>。</p>
<h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><p>安装并修改ImageMagick使用旧字体。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># 安装urw-base35-fonts-legacy, fonts在/usr/share/X11/fonts/urw-fonts目录下</div><div class="line">yum install urw-base35-fonts-legacy</div><div class="line"></div><div class="line"># 修改/etc/ImageMagick-6/type.xml配置文件为使用type-ghostscript.xml</div><div class="line">sed -i.bak &apos;s,type-urw-base35.xml,type-ghostscript.xml,g&apos; /etc/ImageMagick-6/type.xml</div><div class="line"></div><div class="line"># 修改 /etc/ImageMagick-6/type-ghostscript.xml为/usr/share/X11/fonts/urw-fonts/</div><div class="line">sed -i.bak &apos;s,metrics=&quot;,metrics=&quot;/usr/share/X11/fonts/urw-fonts/,g&apos; /etc/ImageMagick-6/type-ghostscript.xml</div><div class="line">sed -i &apos;s,glyphs=&quot;,glyphs=&quot;/usr/share/X11/fonts/urw-fonts/,g&apos; /etc/ImageMagick-6/type-ghostscript.xml</div></pre></td></tr></table></figure>
	
	</div>
  <a type="button" href="/2020/05/04/imageMagick-fonts-issue-on-Aliyun-Linux-2/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2020-04-29 </div>
			<div class="article-title"><a href="/2020/04/29/Install-Postgresql-and-Nodejs-on-Aliyun-Linux-2/" >在Aliyun Linux 2上安装Postgresql和Node.js</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>Aliyun Linux 2上部署环境，遇到了几个问题。记录如下。</p>
<h3 id="安装Postgresql-11-client"><a href="#安装Postgresql-11-client" class="headerlink" title="安装Postgresql 11 client"></a>安装Postgresql 11 client</h3><h4 id="官方Guide"><a href="#官方Guide" class="headerlink" title="官方Guide"></a>官方Guide</h4><ul>
<li>Postgresql官方在红帽系Linux的安装Guide地址: <a href="https://www.postgresql.org/download/linux/redhat/" target="_blank" rel="external">https://www.postgresql.org/download/linux/redhat/</a></li>
<li>Guide中选取对应操作系统后，可以得到Postgresql在RHEL 7系列上的yum源地址是: <a href="https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm" target="_blank" rel="external">https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm</a></li>
</ul>
<p>在RHEL 7系列上安装方法为:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">yum install https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm</div><div class="line">yum install postgresql11</div></pre></td></tr></table></figure>
<h4 id="Aliyun-Linux-2安装问题"><a href="#Aliyun-Linux-2安装问题" class="headerlink" title="Aliyun Linux 2安装问题"></a>Aliyun Linux 2安装问题</h4><p>但该方法在Alinux Linux 2上没法成功安装，因为官方源依赖于yum的变量$releasever,$basearch。在Aliyun Linux 2中，这些变量和RHEL和CentOS上不相同。导致没法直接用官方rpm yum包来安装postgresql11。</p>
	
	</div>
  <a type="button" href="/2020/04/29/Install-Postgresql-and-Nodejs-on-Aliyun-Linux-2/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		

		</div>

		<!-- pagination -->
		<div>
  		<center>
		<div class="pagination">
<ul class="pagination">
	 
		
          <li class="prev disabled"><a><i class="fa fa-arrow-circle-o-left"></i>上一页</a></li>
        

        <li><a href="/"><i class="fa fa-home"></i>Home</a></li>

		
		   <li class="next"> <a href="/page/2/" class="alignright next">下一页<i class="fa fa-arrow-circle-o-right"></i></a> </li>          
        
	
</ul>
</div>

  		</center>
		</div>

		
		
	</div> <!-- col-md-9 -->

	
		<div class="col-md-3">
	<div id="sidebar">
	
			
  <div id="site_search">
   <div class="form-group">
    <input type="text" id="local-search-input" name="q" results="0" placeholder="搜索" class="st-search-input st-default-search-input form-control"/>
   </div>  
  <div id="local-search-result"></div>
  </div>


		
			
<div class="widget">
	<h4>AWS Certification</h4>
    <ul class="blogroll list-unstyled">
    <div class="thumbnail"><a href="/images/AWS/CertificationLogo/AWS_Certified_Logo_Color.png"><img src="/images/AWS/CertificationLogo/AWS_Certified_Logo_Color.png" alt="images"  class="nofancybox"></a>
    </ul>
</div>


		
			<div class="widget">
    
</div>

		
			
	<div class="widget">
		<h4>分类</h4>
		<ul class="tag_box inline list-unstyled">
		
			<li><a href="/categories/#AWS">AWS<span>35</span></a></li>
		
			<li><a href="/categories/#AWS Certified">AWS Certified<span>4</span></a></li>
		
			<li><a href="/categories/#Blog">Blog<span>6</span></a></li>
		
			<li><a href="/categories/#Code">Code<span>5</span></a></li>
		
			<li><a href="/categories/#Kubernetes">Kubernetes<span>1</span></a></li>
		
			<li><a href="/categories/#Linux">Linux<span>11</span></a></li>
		
			<li><a href="/categories/#Shell">Shell<span>8</span></a></li>
		
			<li><a href="/categories/#Tools">Tools<span>30</span></a></li>
		
			<li><a href="/categories/#杂">杂<span>1</span></a></li>
		
		</ul>
	</div>


		
			
	<div class="widget">
		<h4>标签云</h4>
		<ul class="tag_box inline list-unstyled">		
		
			<li><a href="/tags/#CodeCommit">CodeCommit<span>1</span></a></li>
		
			<li><a href="/tags/#Image">Image<span>3</span></a></li>
		
			<li><a href="/tags/#Kubernetes">Kubernetes<span>1</span></a></li>
		
			<li><a href="/tags/#Video">Video<span>1</span></a></li>
		
			<li><a href="/tags/#AWS SDK">AWS SDK<span>2</span></a></li>
		
			<li><a href="/tags/#Solutions Architect">Solutions Architect<span>1</span></a></li>
		
			<li><a href="/tags/#Github">Github<span>4</span></a></li>
		
			<li><a href="/tags/#RVM">RVM<span>3</span></a></li>
		
			<li><a href="/tags/#VMware">VMware<span>2</span></a></li>
		
			<li><a href="/tags/#Chrome">Chrome<span>1</span></a></li>
		
			<li><a href="/tags/#Ruby">Ruby<span>10</span></a></li>
		
			<li><a href="/tags/#Ubuntu">Ubuntu<span>1</span></a></li>
		
			<li><a href="/tags/#Elastic Beanstalk">Elastic Beanstalk<span>7</span></a></li>
		
			<li><a href="/tags/#Udemy">Udemy<span>1</span></a></li>
		
			<li><a href="/tags/#EC2">EC2<span>8</span></a></li>
		
			<li><a href="/tags/#AWS CLI">AWS CLI<span>6</span></a></li>
		
			<li><a href="/tags/#Hexo">Hexo<span>8</span></a></li>
		
			<li><a href="/tags/#AWS Deep Dive">AWS Deep Dive<span>2</span></a></li>
		
			<li><a href="/tags/#DynamoDB">DynamoDB<span>1</span></a></li>
		
			<li><a href="/tags/#FFMPEG">FFMPEG<span>2</span></a></li>
		
		
		   <li><a href="/tags">...<span>66</span></a></li>
		 
		</ul>
	</div>


		
			
<div class="widget">
  <h4>最新文章</h4>
  <ul class="entry list-unstyled">
    
      <li>
        <a href="/2020/07/03/redis-basic/" ><i class="fa fa-file-o"></i>Redis基础</a>
      </li>
    
      <li>
        <a href="/2020/06/29/transaction-isolation-level-in-postgresql-and-mysql/" ><i class="fa fa-file-o"></i>Postgresql和Mysql中的事务隔离</a>
      </li>
    
      <li>
        <a href="/2020/06/23/resolve-sudo-error-in-crontab-job/" ><i class="fa fa-file-o"></i>Crontab中解决sorry, you must h...</a>
      </li>
    
      <li>
        <a href="/2020/06/21/tools-to-control-brightness-of-external-monitor-on-macos/" ><i class="fa fa-file-o"></i>Mac下调节外置显示器亮度的工具</a>
      </li>
    
      <li>
        <a href="/2020/06/09/some-new-nginx-config/" ><i class="fa fa-file-o"></i>一些常用的Nginx+Passenger配置</a>
      </li>
    
  </ul>
</div>

		
			
<div class="widget">
	<h4>链接</h4>
	<ul class="blogroll list-unstyled">
	
		<li><i class="fa fa-github"></i><a href="https://github.com/jibing57/" title="My Github repository." target="_blank"]);">My Github</a></li>
	
		<li><i class="fa fa-linkedin"></i><a href="https://www.linkedin.com/in/honggang-shen-37669214a/" title="My Linkin account." target="_blank"]);">My LinkedIn</a></li>
	
		<li><i class="fa fa-rss"></i><a href="/atom.xml" title="rss." target="_blank"]);">RSS</a></li>
	
		<li><i class="fa fa-sitemap"></i><a href="/sitemap.xml" title="Site Map" target="_blank"]);">Site Map</a></li>
	
	</ul>
</div>


		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->

	
	
</div> <!-- row-fluid -->


	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2020 jibing57
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
